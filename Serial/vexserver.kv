#:import Settings gui.Settings
#:import Data gui.Data

<-ScaleButton@Button>:
	state_image: self.background_normal if self.state == 'normal' else self.background_down
	disabled_image: self.background_disabled_normal if self.state == 'normal' else self.background_disabled_down
	_scale: 1. if self.texture_size[0] < self.width else float(self.width) / self.texture_size[0]
	canvas:
		Color:
			rgba: self.background_color
		BorderImage:
			border: self.border
			pos: self.pos
			size: self.size
			source: self.disabled_image if self.disabled else self.state_image
		PushMatrix
		Scale:
			origin: self.center
			x: self._scale or 1.
			y: self._scale or 1.
		Color:
			rgba: self.disabled_color if self.disabled else self.color
		Rectangle:
			texture: self.texture
			size: self.texture_size
			pos: int(self.center_x - self.texture_size[0] / 2.), int(self.center_y - self.texture_size[1] / 2.)
		PopMatrix

<MainScreen>: 
    TabbedPanel:
        size_hint: 1, 1
        pos_hint: {"x":0, "top":1}
        do_default_tab: False
        tab_height: root.height * .075
    
        TabbedPanelItem:
            text: "Motor\nDashboard"
            FloatLayout:
                Spinner:
                    font_size: self.height / 4
                    text:"Actual Velocity"
                    values: "Actual Velocity", "Actual Voltage", "Encoder Position", "Current Draw", "Brakemode", "Gearset", "Port", "Slew Rate", "Power", "Temperature", "Torque", "Direction", "Efficiency"
                    size_hint: .2, .1
                    pos_hint: {"x":.8, "bottom":1}
                    on_text: app.get_running_app().settings.update_motor_dashboard_selected(self.text)
                    
                ScaleButton:
                    font_size: self.height / 4
                    size_hint: .3, .125
                    pos_hint: {"x":0, "top":1} 
                    text: "Front Right"
                    on_release: app.get_running_app().settings.update_motor_selected(0)
                    
                ScaleButton:
                    font_size: self.height / 4
                    size_hint: .3, .125
                    pos_hint: {"x":0, "top":.875} 
                    text: "Front Left"
                    on_release: app.get_running_app().settings.update_motor_selected(1)
                    
                ScaleButton:
                    font_size: self.height / 4
                    size_hint: .3, .125
                    pos_hint: {"x":0, "top":.75} 
                    text: "Back Right"
                    on_release: app.get_running_app().settings.update_motor_selected(2)
                    
                ScaleButton:
                    font_size: self.height / 4
                    size_hint: .3, .125
                    pos_hint: {"x":0, "top":.625} 
                    text: "Back Left"
                    on_release: app.get_running_app().settings.update_motor_selected(3)
                    
                ScaleButton:
                    font_size: self.height / 4
                    size_hint: .3, .125
                    pos_hint: {"x":0, "top":.5} 
                    text: "Main Intake"
                    on_release: app.get_running_app().settings.update_motor_selected(4)
                    
                ScaleButton:
                    font_size: self.height / 4
                    size_hint: .3, .125
                    pos_hint: {"x":0, "top":.375} 
                    text: "Hoarding Intake"
                    on_release: app.get_running_app().settings.update_motor_selected(5)
                    
                ScaleButton:
                    font_size: self.height / 4
                    size_hint: .3, .125
                    pos_hint: {"x":0, "top":.25} 
                    text: "Lift"
                    on_release: app.get_running_app().settings.update_motor_selected(6)
                    
                Label:
                    font_size: self.height / 5
                    size_hint: .2, .14
                    pos_hint: {"x":.34, "top":1} 
                    text_size: self.size
                    halign: "left"
                    valign: "middle"
                    text: app.l0
                    
                Label:
                    font_size: self.height / 5
                    size_hint: .2, .14
                    pos_hint: {"x":.34, "top":.875} 
                    text_size: self.size
                    halign: "left"
                    valign: "middle"
                    text: app.l1
                    
                Label:
                    font_size: self.height / 5
                    size_hint: .2, .14
                    pos_hint: {"x":.34, "top":.75} 
                    text_size: self.size
                    halign: "left"
                    valign: "middle"
                    text: app.l2
                    
                Label:
                    font_size: self.height / 5
                    size_hint: .2, .14
                    pos_hint: {"x":.34, "top":.625} 
                    text_size: self.size
                    halign: "left"
                    valign: "middle"
                    text: app.l3
                    
                Label:
                    font_size: self.height / 5
                    size_hint: .2, .14
                    pos_hint: {"x":.34, "top":.5} 
                    text_size: self.size
                    halign: "left"
                    valign: "middle"
                    text: app.l4
                    
                Label:
                    font_size: self.height / 5
                    size_hint: .2, .14
                    pos_hint: {"x":.34, "top":.375} 
                    text_size: self.size
                    halign: "left"
                    valign: "middle"
                    text: app.l5
                    
                Label:
                    font_size: self.height / 5
                    size_hint: .2, .14
                    pos_hint: {"x":.34, "top":.25} 
                    text_size: self.size
                    halign: "left"
                    valign: "middle"
                    text: app.l6
                    
                FloatLayout:
                    size_hint: .55, .6
                    pos_hint: {"x":.45, "top":.90}
                    
                    Label:
                        font_size: self.height * .8
                        size_hint: 1, .07
                        pos_hint: {"x":0, "top":1} 
                        text_size: self.size
                        valign: "middle"
                        halign: "center"
                        text: app.motor_data_title
                        
                    Label:
                        font_size: self.height / 17
                        size_hint: 1, .9
                        pos_hint: {"x":0, "top":.8} 
                        text: app.motor_data_body
                        
        
        TabbedPanelItem:
            text: "Tab 2"
            Label:
                text: "This is the second panel"
 
    ScaleButton:
        text: "Settings"
        font_size: self.height / 4
        size_hint: .1, .08
        pos_hint: {"x":.9, "top":1}    
        on_release: root.open_settings()
        
        
<SettingsPopup>:    
    Label:
        text: "Enter IP Address of server"
        size_hint: 0.6, 0.2
        pos_hint: {"x":0.2, "top":1}

    TextInput:
        text: Settings.get_instance().ip_address
        on_text: root.update_ip_addr(self.text)
        multiline: False
        size_hint: 0.8, 0.2
        pos_hint: {"x":0.1, "y":0.5}
        
    
